{"title":"New Folder (2) Copy (6) only CLOUD EUT 3","status":"deploying","content":"apiVersion: \"core.oam.dev/v1beta1\"\r\nkind: \"Application\"\r\nmetadata:\r\n  name: \"tta-models\"\r\nspec:\r\n  components:\r\n  - name: \"minio-pvc\"\r\n    type: \"raw\"\r\n    properties:\r\n      apiVersion: \"v1\"\r\n      kind: \"PersistentVolumeClaim\"\r\n      metadata:\r\n        name: \"minio-pvc\"\r\n      spec:\r\n        storageClassName: \"local-path\"\r\n        accessModes:\r\n        - \"ReadWriteOnce\"\r\n        resources:\r\n          requests:\r\n            storage: \"1Gi\"\r\n  - name: \"minio\"\r\n    type: \"webservice\"\r\n    dependsOn:\r\n    - \"minio-pvc\"\r\n    properties:\r\n      image: \"minio/minio\"\r\n      args:\r\n      - \"server\"\r\n      - \"/data\"\r\n      - \"--console-address\"\r\n      - \":9090\"\r\n      exposeType: \"NodePort\"\r\n      ports:\r\n      - name: \"minio-ui\"\r\n        expose: true\r\n        port: 9090\r\n        nodePort: 30002\r\n        protocol: \"TCP\"\r\n      - name: \"minio-api\"\r\n        expose: true\r\n        port: 9000\r\n        nodePort: 30001\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      volumeMounts:\r\n        pvc:\r\n        - name: \"minio-storage\"\r\n          mountPath: \"/data\"\r\n          claimName: \"minio-pvc\"\r\n      resources: {}\r\n    traits:\r\n      - type: \"annotations\"\r\n        properties:\r\n          \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"object-detection\"\r\n    type: \"webservice\"\r\n    properties:\r\n      cpu: 4\r\n      memory: \"4Gi\"\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/processor-server:latest\"\r\n      ports:\r\n      - name: \"obj-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30010\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"PROCESSOR_NAME\"\r\n        value: \"inference\"\r\n      - name: \"MODEL_FILE\"\r\n        value: \"models/det_model.pkl\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      - name: \"EMS_MODE\"\r\n        value: \"STOMP\"\r\n      - name: \"METRIC_SUFFIX\"\r\n        value: \"Detection\"\r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"damage-classification\"\r\n    type: \"webservice\"\r\n    properties:\r\n      cpu: 4\r\n      memory: \"8Gi\"\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/processor-server:latest\"\r\n      ports:\r\n      - name: \"class-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30011\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"PROCESSOR_NAME\"\r\n        value: \"inference\"\r\n      - name: \"MODEL_FILE\"\r\n        value: \"models/name_model.pkl\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      - name: \"EMS_MODE\"\r\n        value: \"STOMP\"\r\n      - name: \"METRIC_SUFFIX\"\r\n        value: \"DamageType\"\r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"severity-assessment\"\r\n    type: \"webservice\"\r\n    properties:\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/processor-server:latest\"\r\n      ports:\r\n      - name: \"sev-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30012\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"PROCESSOR_NAME\"\r\n        value: \"inference\"\r\n      - name: \"MODEL_FILE\"\r\n        value: \"models/sev_model.pkl\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      - name: \"EMS_MODE\"\r\n        value: \"STOMP\"\r\n      - name: \"METRIC_SUFFIX\"\r\n        value: \"Severity\"\r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"cropping\"\r\n    type: \"webservice\"\r\n    properties:\r\n      cpu: 4\r\n      memory: \"4Gi\"\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/processor-server:latest\"\r\n      ports:\r\n      - name: \"obj-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30013\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"PROCESSOR_NAME\"\r\n        value: \"cropping\"\r\n      - name: \"FILE_PREFIX\"\r\n        value: \"minio://cloud/crops\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      - name: \"EMS_MODE\"\r\n        value: \"STOMP\"\r\n      - name: \"METRIC_SUFFIX\"\r\n        value: \"Cropping\"\r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"orchestrator-edge\"\r\n    type: \"webservice\"\r\n    properties:\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/orchestrator:latest\"\r\n      ports:\r\n      - name: \"obj-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30014\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"FLOW_NAME\"\r\n        value: \"edge\"\r\n      - name: \"RESULT_PREFIX\"\r\n        value: \"minio://edge/data\"\r\n      - name: \"OBJ_DETECTION_SERVICE\"\r\n        value: \"object-detection:8000\"\r\n      - name: \"CLOUD_ORCHESTRATOR\"\r\n        value: \"orchestrator-cloud:8000\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      - name: \"EMS_MODE\"\r\n        value: \"STOMP\"\r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"orchestrator-cloud\"\r\n    type: \"webservice\"\r\n    properties:\r\n      exposeType: \"NodePort\"\r\n      image: \"ttanebulous/orchestrator:latest\"\r\n      ports:\r\n      - name: \"obj-pred\"\r\n        expose: true\r\n        port: 8000\r\n        nodePort: 30015\r\n        protocol: \"TCP\"\r\n      env:\r\n      - name: \"MINIO_ACCESS_KEY\"\r\n        value: \"aaa\"\r\n      - name: \"MINIO_SECRET_KEY\"\r\n        value: \"marchel1\"\r\n      - name: \"MINIO_ENDPOINT\"\r\n        value: \"minio:9000\"\r\n      - name: \"FLOW_NAME\"\r\n        value: \"cloud\"\r\n      - name: \"CROP_SERVICE\"\r\n        value: \"cropping:8000\"\r\n      - name: \"CLS_SERVICE\"\r\n        value: \"damage-classification:8000\"\r\n      - name: \"SEV_SERVICE\"\r\n        value: \"severity-assessment:8000\"\r\n      - name: \"MQ_HOST\"\r\n        valueFrom:  \r\n          fieldRef:  \r\n            fieldPath: status.hostIP  \r\n      - name: \"MQ_PORT\"\r\n        value: '61610'  \r\n      - name: \"MQ_USER\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_USERNAME  \r\n      - name: \"MQ_PASS\"\r\n        valueFrom:  \r\n          configMapKeyRef:  \r\n            name: monitoring-configmap  \r\n            key: BROKER_PASSWORD  \r\n      resources: {}\r\n    traits:\r\n    - type: \"scaler\"\r\n      properties:\r\n        replicas: 1\r\n    - type: \"annotations\"\r\n      properties:\r\n        \"nebulous-placement-constraint\":  \"CLOUD\"\r\n  - name: \"activemq\"\r\n    type: \"webservice\"\r\n    properties:\r\n      image: \"rmohr/activemq:latest\"\r\n      ports:\r\n      - port: 8161\r\n        expose: true\r\n        nodePort: 30016\r\n        protocol: \"TCP\"\r\n      - port: 61613\r\n        expose: true\r\n        nodePort: 30017\r\n      env:\r\n      - name: \"ACTIVEMQ_ADMIN_LOGIN\"\r\n        value: \"admin\"\r\n      - name: \"ACTIVEMQ_ADMIN_PASSWORD\"\r\n        value: \"admin\"\r\n      resources: {}\r\n    traits:\r\n      - type: \"annotations\"\r\n        properties:\r\n          \"nebulous-placement-constraint\":  \"CLOUD\"","variables":[{"key":"spec_components_5_properties_cpu","path":"/spec/components/5/properties/cpu","type":"float","meaning":"cpu","value":{"lower_bound":4,"higher_bound":8}},{"key":"spec_components_5_properties_memory","path":"/spec/components/5/properties/memory","type":"float","meaning":"memory","value":{"lower_bound":4,"higher_bound":8}}],"environmentVariables":[],"resources":[{"title":"dummy_aws","uuid":"7527214f-1c3d-40e0-9b70-efb41b021fe6","platform":"AWS","enabled":false,"regions":"us-east-1"},{"title":"eut","uuid":"27604351-0725-464c-b933-fbe294d1ea13","platform":"AWS","enabled":true,"regions":"us-east-1"},{"title":"tta3","uuid":"16dd86ec-2d26-4535-bfda-963ab82b2498","platform":"AWS","enabled":false,"regions":"eu-central-1"}],"templates":[{"id":"Count","type":"int","minValue":0,"maxValue":10000,"unit":"count"},{"id":"Usage","type":"int","minValue":0,"maxValue":100,"unit":"%"}],"parameters":[],"metrics":[{"type":"raw","name":"CroppingImagesCount","level":"global","components":[],"sensor":"job_cropping_images_count","config":[],"isWindowOutputRaw":false,"outputRaw":{"type":"all","interval":0,"unit":"ms"}},{"type":"raw","name":"CroppingImagesProcTime","level":"global","components":[],"sensor":"job_cropping_images_proctime","config":[],"isWindowOutputRaw":false,"outputRaw":{"type":"all","interval":0,"unit":"ms"}},{"type":"raw","name":"SeverityImagesCount","level":"global","components":[],"sensor":"job_severity_images_count","config":[],"isWindowOutputRaw":false,"outputRaw":{"type":"all","interval":0,"unit":"ms"}},{"type":"raw","name":"SeverityImagesProcTime","level":"global","components":[],"sensor":"job_severity_images_proctime","config":[],"isWindowOutputRaw":false,"outputRaw":{"type":"all","interval":0,"unit":"ms"}}],"sloViolations":{"nodeKey":"cfc060f2-8ae2-42db-b506-c0c1b225f912","isComposite":true,"condition":"OR","not":false,"children":[{"nodeKey":"2f15d807-82cc-459f-b77a-145260e63a73","isComposite":false,"metricName":"CroppingImagesCount","operator":">","value":100}]},"utilityFunctions":[{"name":"SimpleUF","type":"maximize","expression":{"formula":"abs(CroppingImagesCount-(CPU*3))","variables":[{"name":"CroppingImagesCount","value":"CroppingImagesCount"},{"name":"CPU","value":"spec_components_5_properties_cpu"}]}}],"uuid":"10b6c999-a7be-4425-a36f-4de1d702d79d","_create":true,"_delete":true}
